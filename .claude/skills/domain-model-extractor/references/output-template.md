# Output Template

ドメインモデル提案の出力テンプレート。擬似コード付きMarkdown形式。

## 目次

- [全体構成](#全体構成) - ドキュメント全体のMarkdown構造
- [擬似コードの記法規約](#擬似コードの記法規約) - Aggregate/Entity/ValueObject等の記法

## 全体構成

```markdown
# ドメインモデル提案: {コンテキスト名}

## 概要
- 分析対象: {分析したコードの範囲}
- 発見した集約: N個
- 発見した値オブジェクト: N個
- 発見したドメインサービス: N個

## 集約一覧

### {集約名} 集約

**責務**: {一文で説明}
**整合性境界**: {何を一貫性のある単位として守るか}
**根拠**: {既存コードのどこからこの集約を導出したか}

```pseudo
Aggregate {集約名} {
  // === Identity ===
  id: {集約名}Id

  // === Properties (値オブジェクト) ===
  name: {Name型}
  status: {Status型}
  ...

  // === Local Entities ===
  items: List<{ローカルエンティティ名}>

  // === Invariants (不変条件) ===
  // - {不変条件1の説明}
  // - {不変条件2の説明}

  // === Factory Method ===
  static create(params...): {集約名}
    // {生成時の検証ロジック}

  // === Commands (状態変更) ===
  changeName(newName: Name): {集約名}
    // {事前条件}
    // {処理}
    // returns 新しいインスタンス

  addItem(item: {ローカルエンティティ名}): {集約名}
    // {不変条件チェック}
    // returns 新しいインスタンス

  // === Queries (状態参照) ===
  isActive(): Boolean
  totalAmount(): Money
}
```

#### ローカルエンティティ: {ローカルエンティティ名}

```pseudo
Entity {ローカルエンティティ名} {
  id: {ローカルエンティティ名}Id
  // properties...

  // methods...
}
```

---

## 値オブジェクト一覧

### {値オブジェクト名}

**由来**: {既存コードのどのフィールド/概念から導出したか}
**制約**: {検証ルール}

```pseudo
ValueObject {値オブジェクト名} {
  // === Fields ===
  value: {基底型}

  // === Validation ===
  static create(raw: {基底型}): Result<{値オブジェクト名}, Error>
    // {検証ルール}

  // === Behavior ===
  // {ドメイン固有の操作}
}
```

---

## ドメインサービス一覧

### {ドメインサービス名}

**責務**: {一文で説明}
**根拠**: {なぜエンティティ/値オブジェクトに属さないか}

```pseudo
DomainService {ドメインサービス名} {
  execute(param1: Type1, param2: Type2): ResultType
    // {処理の概要}
}
```

---

## 集約関連図

```
{集約A} --[IDで参照]--> {集約B}
{集約A} ◆--[包含]--> {ローカルエンティティ}
{集約A} ○--[使用]--> {値オブジェクト}
```

## 既存コードとの対応表

| 既存コード | 提案するドメインモデル | 分類 |
|-----------|----------------------|------|
| {既存クラス/テーブル} | {提案モデル} | 集約/エンティティ/VO/サービス |
```

## 擬似コードの記法規約

| 記法 | 意味 |
|------|------|
| `Aggregate` | 集約ルート |
| `Entity` | ローカルエンティティ |
| `ValueObject` | 値オブジェクト |
| `DomainService` | ドメインサービス |
| `static create(...)` | ファクトリメソッド（Smart Constructor） |
| `Result<T, E>` | 成功/失敗を表す型 |
| `List<T>` | コレクション |
| returns 新しいインスタンス | 不変性（既存を変更せず新規作成） |
